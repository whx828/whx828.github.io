<!DOCTYPE html>
<html lang="en-us">
<head>
  <link rel="preload" href="/lib/font-awesome/webfonts/fa-brands-400.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <link rel="preload" href="/lib/font-awesome/webfonts/fa-regular-400.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <link rel="preload" href="/lib/font-awesome/webfonts/fa-solid-900.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <link rel="preload" href="/lib/JetBrainsMono/web/woff2/JetBrainsMono-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <script type="text/javascript" src="https://latest.cactus.chat/cactus.js"></script>
  <link rel="stylesheet" href="https://latest.cactus.chat/style.css" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title> Rust 的迭代器 | whx&#39;s Blog</title>
  <link rel = 'canonical' href = 'https://whx828.github.io/posts/rust%E7%9A%84%E8%BF%AD%E4%BB%A3%E5%99%A8/'>
  <meta name="description" content="Patience is not passive, on the contrary, it is concentrated strength.">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="robots" content="all,follow">
  <meta name="googlebot" content="index,follow,snippet,archive">
  <meta property="og:title" content="Rust 的迭代器" />
<meta property="og:description" content="Iterator Iterators and “iterables” in Rust The iterator keeps track of what element it&rsquo;s currently pointing to and supports at least the following basic operations:
Iterator 跟踪它当前指向的元素，并至少支持以下基本操作：
 getting the current element 获取当前元素 advancing to the next element 前进到下一个元素 signaling when no more elements are available 当没有更多元素可用时发出信号  Some languages provide separate iterator methods for each of those tasks, but Rust chooses to combine them all into one. You can see that when looking at the Iterator trait: next is the only method to be provided by its implementations." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://whx828.github.io/posts/rust%E7%9A%84%E8%BF%AD%E4%BB%A3%E5%99%A8/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-04-01T10:19:33+08:00" />
<meta property="article:modified_time" content="2022-04-01T10:19:33+08:00" />


  <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Rust 的迭代器"/>
<meta name="twitter:description" content="Iterator Iterators and “iterables” in Rust The iterator keeps track of what element it&rsquo;s currently pointing to and supports at least the following basic operations:
Iterator 跟踪它当前指向的元素，并至少支持以下基本操作：
 getting the current element 获取当前元素 advancing to the next element 前进到下一个元素 signaling when no more elements are available 当没有更多元素可用时发出信号  Some languages provide separate iterator methods for each of those tasks, but Rust chooses to combine them all into one. You can see that when looking at the Iterator trait: next is the only method to be provided by its implementations."/>

  
  
    
  
  
  <link rel="stylesheet" href="https://whx828.github.io/css/styles.94f653e9e151e28067a7c5dbbc4600cbd5a3c721e79faaf971e523c40f3b249b8e4f20bb57810dfffa8d559ca5c140fd56eb4cd9c0853113ad08e66afdb08bdd.css" integrity="sha512-lPZT6eFR4oBnp8XbvEYAy9WjxyHnn6r5ceUjxA87JJuOTyC7V4EN//qNVZylwUD9VutM2cCFMROtCOZq/bCL3Q=="> 

  
   <link rel="stylesheet" href="https://whx828.github.io/css/custom.css"> 
  
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  

  
<link rel="icon" type="image/png" href="https://whx828.github.io/images/favicon.ico" />

  
  
  
  
</head>

<body class="max-width mx-auto px3 ltr">
  <div class="content index py4">

  <div id="header-post">
  <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;" aria-label="Top of Page"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
        <li><a href="/">Home</a></li>
         
        <li><a href="/about">About</a></li>
         
        <li><a href="/posts">All posts</a></li>
         
        <li><a href="/index.xml">RSS</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li>
          <a class="icon" href=" https://whx828.github.io/about/" aria-label="Previous">
            <i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i>
          </a>
        </li>
        
        
        <li>
          <a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" aria-label="Top of Page">
            <i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i>
          </a>
        </li>
        <li>
          <a class="icon" href="#" aria-label="Share">
            <i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i>
          </a>
        </li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      
      <ul>
  
  
    
  
  
  <li>
    <a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fwhx828.github.io%2fposts%2frust%25E7%259A%2584%25E8%25BF%25AD%25E4%25BB%25A3%25E5%2599%25A8%2f" aria-label="Facebook">
      <i class="fab fa-facebook " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://twitter.com/share?url=https%3a%2f%2fwhx828.github.io%2fposts%2frust%25E7%259A%2584%25E8%25BF%25AD%25E4%25BB%25A3%25E5%2599%25A8%2f&text=Rust%20%e7%9a%84%e8%bf%ad%e4%bb%a3%e5%99%a8" aria-label="Twitter">
      <i class="fab fa-twitter " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2fwhx828.github.io%2fposts%2frust%25E7%259A%2584%25E8%25BF%25AD%25E4%25BB%25A3%25E5%2599%25A8%2f&title=Rust%20%e7%9a%84%e8%bf%ad%e4%bb%a3%e5%99%a8" aria-label="Linkedin">
      <i class="fab fa-linkedin " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2fwhx828.github.io%2fposts%2frust%25E7%259A%2584%25E8%25BF%25AD%25E4%25BB%25A3%25E5%2599%25A8%2f&is_video=false&description=Rust%20%e7%9a%84%e8%bf%ad%e4%bb%a3%e5%99%a8" aria-label="Pinterest">
      <i class="fab fa-pinterest " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="mailto:?subject=Rust%20%e7%9a%84%e8%bf%ad%e4%bb%a3%e5%99%a8&body=Check out this article: https%3a%2f%2fwhx828.github.io%2fposts%2frust%25E7%259A%2584%25E8%25BF%25AD%25E4%25BB%25A3%25E5%2599%25A8%2f" aria-label="Email">
      <i class="fas fa-envelope " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2fwhx828.github.io%2fposts%2frust%25E7%259A%2584%25E8%25BF%25AD%25E4%25BB%25A3%25E5%2599%25A8%2f&title=Rust%20%e7%9a%84%e8%bf%ad%e4%bb%a3%e5%99%a8" aria-label="Pocket">
      <i class="fab fa-get-pocket " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2fwhx828.github.io%2fposts%2frust%25E7%259A%2584%25E8%25BF%25AD%25E4%25BB%25A3%25E5%2599%25A8%2f&title=Rust%20%e7%9a%84%e8%bf%ad%e4%bb%a3%e5%99%a8" aria-label="reddit">
      <i class="fab fa-reddit " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.tumblr.com/share/link?url=https%3a%2f%2fwhx828.github.io%2fposts%2frust%25E7%259A%2584%25E8%25BF%25AD%25E4%25BB%25A3%25E5%2599%25A8%2f&name=Rust%20%e7%9a%84%e8%bf%ad%e4%bb%a3%e5%99%a8&description=Iterator%20Iterators%20and%20%e2%80%9citerables%e2%80%9d%20in%c2%a0Rust%20The%20iterator%20keeps%20track%20of%20what%20element%20it%26rsquo%3bs%20currently%20pointing%20to%20and%20supports%20at%20least%20the%20following%20basic%c2%a0operations%3a%0aIterator%20%e8%b7%9f%e8%b8%aa%e5%ae%83%e5%bd%93%e5%89%8d%e6%8c%87%e5%90%91%e7%9a%84%e5%85%83%e7%b4%a0%ef%bc%8c%e5%b9%b6%e8%87%b3%e5%b0%91%e6%94%af%e6%8c%81%e4%bb%a5%e4%b8%8b%e5%9f%ba%e6%9c%ac%e6%93%8d%e4%bd%9c%ef%bc%9a%0a%20getting%20the%20current%c2%a0element%20%e8%8e%b7%e5%8f%96%e5%bd%93%e5%89%8d%e5%85%83%e7%b4%a0%20advancing%20to%20the%20next%c2%a0element%20%e5%89%8d%e8%bf%9b%e5%88%b0%e4%b8%8b%e4%b8%80%e4%b8%aa%e5%85%83%e7%b4%a0%20signaling%20when%20no%20more%20elements%20are%c2%a0available%20%e5%bd%93%e6%b2%a1%e6%9c%89%e6%9b%b4%e5%a4%9a%e5%85%83%e7%b4%a0%e5%8f%af%e7%94%a8%e6%97%b6%e5%8f%91%e5%87%ba%e4%bf%a1%e5%8f%b7%20%20Some%20languages%20provide%20separate%20iterator%20methods%20for%20each%20of%20those%20tasks%2c%20but%20Rust%20chooses%20to%20combine%20them%20all%20into%20one.%20You%20can%20see%20that%20when%20looking%20at%20the%20Iterator%20trait%3a%20next%20is%20the%20only%20method%20to%20be%20provided%20by%20its%c2%a0implementations." aria-label="Tumblr">
      <i class="fab fa-tumblr " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fwhx828.github.io%2fposts%2frust%25E7%259A%2584%25E8%25BF%25AD%25E4%25BB%25A3%25E5%2599%25A8%2f&t=Rust%20%e7%9a%84%e8%bf%ad%e4%bb%a3%e5%99%a8" aria-label="Hacker News">
      <i class="fab fa-hacker-news " aria-hidden="true"></i>
    </a>
  </li>
</ul>

    </div>
    
    <div id="toc">
      <nav id="TableOfContents">
  <ul>
    <li><a href="#iterator">Iterator</a>
      <ul>
        <li><a href="#iterators-and-iterables-inrust">Iterators and “iterables” in Rust</a></li>
        <li><a href="#the-three-forms-of-iteration">The three forms of iteration</a></li>
        <li><a href="#implementing-iterator">Implementing Iterator</a>
          <ul>
            <li><a href="#for-loops-and-intoiterator"><code>for</code> loops and <code>IntoIterator</code></a></li>
          </ul>
        </li>
        <li><a href="#代码分析">代码分析</a></li>
        <li><a href="#代码实例">代码实例</a></li>
      </ul>
    </li>
  </ul>
</nav>
    </div>
    
  </span>
</div>


  <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
    <header>
      <h1 class="posttitle" itemprop="name headline">
        Rust 的迭代器
      </h1>
      <div class="meta">
        
        <div class="postdate">
          
          <time datetime="2022-04-01 10:19:33 &#43;0800 CST" itemprop="datePublished">2022-04-01</time>
          
        </div>
        
        
        <div class="article-read-time">
          <i class="far fa-clock"></i>
          
          12 minute read
        </div>
        
        
        <div class="article-category">
            <i class="fas fa-archive"></i>
            
            
            <a class="category-link" href="/categories/rust">Rust</a>
            
        </div>
        
        
        <div class="article-tag">
            <i class="fas fa-tag"></i>
            
            
            <a class="tag-link" href="/tags/%E5%AD%A6%E4%B9%A0" rel="tag">学习</a>
            
        </div>
        
      </div>
    </header>

  
    
    <div class="content" itemprop="articleBody">
      <h2 id="iterator">Iterator</h2>
<h3 id="iterators-and-iterables-inrust">Iterators and “iterables” in Rust</h3>
<p>The iterator keeps track of what element it&rsquo;s currently pointing to and supports at least the following basic operations:</p>
<p><code>Iterator</code> 跟踪它当前指向的元素，并至少支持以下基本操作：</p>
<ul>
<li>getting the current element</li>
<li>获取当前元素</li>
<li>advancing to the next element</li>
<li>前进到下一个元素</li>
<li>signaling when no more elements are available</li>
<li>当没有更多元素可用时发出信号</li>
</ul>
<p>Some languages provide separate iterator methods for each of those tasks, but Rust chooses to combine them all into one. You can see that when looking at the <a href="https://doc.rust-lang.org/std/iter/trait.Iterator.html"><code>Iterator</code> trait</a>: <code>next</code> is the only method to be provided by its implementations.</p>
<p>一些语言为这些任务中的每一个提供单独的 <code>Iterator</code> 方法，但 Rust 选择将它们组合成一个。您可以在查看 <code>Iterator Trait</code> 时看到：<code>next</code> 是其实现提供的唯一方法。</p>
<p>The core of <a href="https://doc.rust-lang.org/std/iter/trait.Iterator.html" title="Iterator"><code>Iterator</code></a> looks like this:</p>
<p><code>Iterator</code> 的核心是这样的：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-rust" data-lang="rust"><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span><span style="color:#ff79c6">trait</span> <span style="color:#8be9fd;font-style:italic">Iterator</span> {
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span><span>    <span style="color:#ff79c6">type</span> <span style="color:#50fa7b">Item</span>;
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span><span>    <span style="color:#ff79c6">fn</span> <span style="color:#50fa7b">next</span>(<span style="color:#ff79c6">&amp;</span><span style="color:#ff79c6">mut</span> self) -&gt; <span style="color:#8be9fd;font-style:italic">Option</span><span style="color:#ff79c6">&lt;</span>Self::Item<span style="color:#ff79c6">&gt;</span>;
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4</span><span>}
</span></span></code></pre></div><p>An iterator has a method, <a href="https://doc.rust-lang.org/std/iter/trait.Iterator.html#tymethod.next"><code>next</code></a>, which when called, returns an <a href="https://doc.rust-lang.org/std/option/enum.Option.html" title="Option">Option</a><code>&lt;Item&gt;</code>. Calling <a href="https://doc.rust-lang.org/std/iter/trait.Iterator.html#tymethod.next"><code>next</code></a> will return <a href="https://doc.rust-lang.org/std/option/enum.Option.html#variant.Some"><code>Some(Item)</code></a> as long as there are elements, and once they&rsquo;ve all been exhausted, will return <code>None</code> to indicate that iteration is finished. Individual iterators may choose to resume iteration, and so calling <a href="https://doc.rust-lang.org/std/iter/trait.Iterator.html#tymethod.next"><code>next</code></a> again may or may not eventually start returning <a href="https://doc.rust-lang.org/std/option/enum.Option.html#variant.Some"><code>Some(Item)</code></a> again at some point (for example, see <a href="https://doc.rust-lang.org/std/sync/mpsc/struct.TryIter.html"><code>TryIter</code></a>).</p>
<p><code>Iterator</code> 有一个方法 <code>next</code>，当 <code>next</code> 被调用时，返回 <code>Option&lt;Item&gt;</code>。只要还有元素，调用 <code>next</code> 就会返回 <code>Some(Item)</code> ，一旦元素被耗尽，将返回 <code>None</code>，表示迭代完成。个别 <code>Iterator</code> 可能会选择恢复迭代，因此再次调用 <code>next</code> 可能会可能不会在某个时间点再次开始返回 <code>Some(Item)</code>（例如 <code>TryIter</code>）。</p>
<p><a href="https://doc.rust-lang.org/std/iter/trait.Iterator.html" title="Iterator"><code>Iterator</code></a>&rsquo;s full definition includes a number of other methods as well, but they are default methods, built on top of <a href="https://doc.rust-lang.org/std/iter/trait.Iterator.html#tymethod.next"><code>next</code></a>, and so you get them for free.</p>
<p><code>Iterator</code> 的完整定义还包括许多其他方法，但它们是默认方法，构建在 <code>next</code> 之上，因此您可以轻松使用它们。</p>
<h3 id="the-three-forms-of-iteration">The three forms of iteration</h3>
<p>There are three common methods which can create iterators from a collection:</p>
<p>有三种常用方法可以从 collection 创建 <code>Iterator</code>：</p>
<ul>
<li><code>iter()</code>, which iterates over <code>&amp;T</code>.</li>
<li><code>iter()</code>，遍历 <code>&amp;T</code>。</li>
<li><code>iter_mut()</code>, which iterates over <code>&amp;mut T</code>.</li>
<li><code>iter_mut()</code>，遍历 <code>&amp;mut T</code>。</li>
<li><code>into_iter()</code>, which iterates over <code>T</code>.</li>
<li><code>into_iter()</code>，遍历 <code>T</code>。</li>
</ul>
<blockquote>
<p>What is the difference between <code>iter</code> and <code>into_iter</code>?
<code>iter</code> 和 <code>into_iter</code> 有什么区别？</p>
</blockquote>
<p><code>into_iter</code> is a generic method to obtain an iterator, whether this iterator yields values, immutable references or mutable references <strong>is context dependent</strong> and can sometimes be surprising.</p>
<p><code>into_iter</code> 是获取 <code>Iterator</code> 的通用方法，该 <code>Iterator</code> 是否产生值、不可变引用或可变引用 <strong>取决于上下文</strong>，有时可能会令人惊讶。</p>
<p><code>iter</code> and <code>iter_mut</code> are ad-hoc methods. Their return type is therefore independent of the context, and will conventionally be iterators yielding immutable references and mutable references, respectively.</p>
<p><code>iter</code> 和 <code>iter_mut</code> 是临时方法。因此，它们的返回类型 <strong>独立于上下文</strong>，并且 <code>Iterator</code> 通常分别产生不可变引用和可变引用。</p>
<h3 id="implementing-iterator">Implementing Iterator</h3>
<p>Creating an iterator of your own involves two steps: creating a <code>struct</code> to hold the iterator&rsquo;s state, and then implementing <a href="https://doc.rust-lang.org/std/iter/trait.Iterator.html" title="Iterator"><code>Iterator</code></a> for that <code>struct</code>. This is why there are so many <code>struct</code>s in this module: there is one for each iterator and iterator adapter.</p>
<p>创建一个自己的 <code>Iterator</code> 需要两个步骤：</p>
<ol>
<li>创建结构体来保存 <code>Iterator</code> 的状态；</li>
<li>然后为该结构体实现 <code>Iterator</code> Trait。</li>
</ol>
<p>这就是为什么本模块中有这么多结构体：每个 <code>Iterator</code> 和 <code>Iterator</code> 适配器都有一个。</p>
<p>Rust has a construct which can call <a href="https://doc.rust-lang.org/std/iter/trait.Iterator.html#tymethod.next"><code>next</code></a> on your iterator, until it reaches <code>None</code>.</p>
<p>Rust 有一个结构，可以对你的 <code>Iterator</code> 调用 <code>next</code>，直到它达到 <code>None</code>。</p>
<p>Also note that <code>Iterator</code> provides a default implementation of methods such as <code>nth</code> and <code>fold</code> which call <code>next</code> internally. However, it is also possible to write a custom implementation of methods like <code>nth</code> and <code>fold</code> if an iterator can compute them more efficiently without calling <code>next</code>.</p>
<p>还要注意的是，<code>Iterator</code> 提供了默认的方法实现，比如内部调用 <code>next</code> 的 <code>nth</code> 和 <code>fold</code>。</p>
<p>如果一个 <code>Iterator</code> 可以在不调用 <code>next</code> 的情况下更有效地计算 <code>nth</code> 和 <code>fold</code> 等方法，也可以写一个自定义的实现。</p>
<h4 id="for-loops-and-intoiterator"><code>for</code> loops and <code>IntoIterator</code></h4>
<p>We never called anything on our collection to produce an iterator. What gives?</p>
<p>实际上，我们从未在我们的 collection 上调用任何东西来生成 <code>Iterator</code>。那么这到底是怎么回事呢？</p>
<p>There&rsquo;s a trait in the standard library for converting something into an iterator: <a href="https://doc.rust-lang.org/std/iter/trait.IntoIterator.html" title="IntoIterator"><code>IntoIterator</code></a>. This trait has one method, <a href="https://doc.rust-lang.org/std/iter/trait.IntoIterator.html#tymethod.into_iter"><code>into_iter</code></a>, which converts the thing implementing <a href="https://doc.rust-lang.org/std/iter/trait.IntoIterator.html" title="IntoIterator"><code>IntoIterator</code></a> into an iterator.</p>
<p>在标准库中，有一个 <code>Trait</code> 可以将某些东西转换为 <code>Iterator</code>。<code>IntoIterator</code>。这个 <code>Trait</code> 有一个方法，<code>into_iter</code>，可以将实现 <code>IntoIterator Trait</code> 的东西转换成一个 <code>Iterator</code>。 #Rust/迭代器</p>
<p>The standard library contains an interesting implementation of <a href="https://doc.rust-lang.org/std/iter/trait.IntoIterator.html" title="IntoIterator"><code>IntoIterator</code></a>:</p>
<p>标准库包含一个有趣的 <code>IntoIterator</code> 实现：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Rust" data-lang="Rust"><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span><span style="color:#ff79c6">impl</span><span style="color:#ff79c6">&lt;</span>I: <span style="color:#8be9fd;font-style:italic">Iterator</span><span style="color:#ff79c6">&gt;</span> <span style="color:#8be9fd;font-style:italic">IntoIterator</span> <span style="color:#ff79c6">for</span> I
</span></span></code></pre></div><p>In other words, all <a href="https://doc.rust-lang.org/std/iter/trait.Iterator.html" title="Iterator"><code>Iterator</code></a>s implement <a href="https://doc.rust-lang.org/std/iter/trait.IntoIterator.html" title="IntoIterator"><code>IntoIterator</code></a>, by just returning themselves. This means three things:</p>
<p>换句话说，所有 <code>Iterator</code> 都通过<strong>返回自身</strong>来<strong>实现 <code>IntoIterator</code></strong>。这意味着三件事：</p>
<ol>
<li>If you&rsquo;re writing an <a href="https://doc.rust-lang.org/std/iter/trait.Iterator.html" title="Iterator"><code>Iterator</code></a>, you can use it with a <code>for</code> loop.
如果你正在编写一个 <code>Iterator</code>，你可以将它与 <code>for</code> 循环一起使用。</li>
<li>If you&rsquo;re creating a collection, implementing <a href="https://doc.rust-lang.org/std/iter/trait.IntoIterator.html" title="IntoIterator"><code>IntoIterator</code></a> for it will allow your collection to be used with the <code>for</code> loop.
如果你正在创建一个 collection，为它实现 <code>IntoIterator</code> 将允许你的 collection 与 <code>for</code> 循环一起使用。</li>
<li>You implement this trait when you want to specify how a particular type is to be converted into an iterator.
当您想指定如何将特定类型转换为 <code>Iterator</code> 时，您可以实现 <code>IntoIterator trait</code>。</li>
</ol>
<hr>
<h3 id="代码分析">代码分析</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Rust" data-lang="Rust"><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span><span style="color:#ff79c6">pub</span> <span style="color:#ff79c6">struct</span> <span style="color:#50fa7b">LinkedList</span><span style="color:#ff79c6">&lt;</span>T<span style="color:#ff79c6">&gt;</span> {
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span><span>	head: <span style="color:#8be9fd;font-style:italic">Option</span><span style="color:#ff79c6">&lt;</span><span style="color:#8be9fd;font-style:italic">Box</span><span style="color:#ff79c6">&lt;</span>Node<span style="color:#ff79c6">&lt;</span>T<span style="color:#ff79c6">&gt;&gt;&gt;</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span><span>    size: <span style="color:#8be9fd">usize</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span><span>}
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span><span><span style="color:#ff79c6">struct</span> <span style="color:#50fa7b">Node</span><span style="color:#ff79c6">&lt;</span>T<span style="color:#ff79c6">&gt;</span> {
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span><span>	value: <span style="color:#50fa7b">T</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span><span>	next: <span style="color:#8be9fd;font-style:italic">Option</span><span style="color:#ff79c6">&lt;</span><span style="color:#8be9fd;font-style:italic">Box</span><span style="color:#ff79c6">&lt;</span>Node<span style="color:#ff79c6">&lt;</span>T<span style="color:#ff79c6">&gt;&gt;&gt;</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span><span>}
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span><span><span style="color:#ff79c6">impl</span><span style="color:#ff79c6">&lt;</span>T<span style="color:#ff79c6">&gt;</span> Node<span style="color:#ff79c6">&lt;</span>T<span style="color:#ff79c6">&gt;</span> {
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span><span>	<span style="color:#ff79c6">pub</span> <span style="color:#ff79c6">fn</span> <span style="color:#50fa7b">new</span>(value: <span style="color:#50fa7b">T</span>, next: <span style="color:#8be9fd;font-style:italic">Option</span><span style="color:#ff79c6">&lt;</span><span style="color:#8be9fd;font-style:italic">Box</span><span style="color:#ff79c6">&lt;</span>Node<span style="color:#ff79c6">&lt;</span>T<span style="color:#ff79c6">&gt;&gt;&gt;</span>) -&gt; <span style="color:#50fa7b">Node</span><span style="color:#ff79c6">&lt;</span>T<span style="color:#ff79c6">&gt;</span> {
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13</span><span>		Node { value, next }
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14</span><span>	}
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15</span><span>}
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17</span><span><span style="color:#ff79c6">impl</span><span style="color:#ff79c6">&lt;</span>T<span style="color:#ff79c6">&gt;</span> LinkedList<span style="color:#ff79c6">&lt;</span>T<span style="color:#ff79c6">&gt;</span> {
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18</span><span>	<span style="color:#ff79c6">pub</span> <span style="color:#ff79c6">fn</span> <span style="color:#50fa7b">new</span>() -&gt; <span style="color:#50fa7b">LinkedList</span><span style="color:#ff79c6">&lt;</span>T<span style="color:#ff79c6">&gt;</span> {
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19</span><span>		LinkedList {
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20</span><span>			head: <span style="color:#8be9fd;font-style:italic">None</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21</span><span>			size: <span style="color:#bd93f9">0</span>
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22</span><span>		}
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23</span><span>	}
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24</span><span>	
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25</span><span>	<span style="color:#6272a4">// ...
</span></span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26</span><span><span style="color:#6272a4"></span>	
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27</span><span>	<span style="color:#ff79c6">pub</span> <span style="color:#ff79c6">fn</span> <span style="color:#50fa7b">pop_front</span>(<span style="color:#ff79c6">&amp;</span><span style="color:#ff79c6">mut</span> self) -&gt; <span style="color:#8be9fd;font-style:italic">Option</span><span style="color:#ff79c6">&lt;</span>T<span style="color:#ff79c6">&gt;</span> {
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28</span><span>		<span style="color:#8be9fd;font-style:italic">let</span> node: <span style="color:#8be9fd;font-style:italic">Box</span><span style="color:#ff79c6">&lt;</span>Node<span style="color:#ff79c6">&lt;</span>T<span style="color:#ff79c6">&gt;&gt;</span> <span style="color:#ff79c6">=</span> self.head.take()<span style="color:#ff79c6">?</span>;
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29</span><span>		self.head <span style="color:#ff79c6">=</span> node.next;
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30</span><span>		self.size <span style="color:#ff79c6">-=</span> <span style="color:#bd93f9">1</span>;
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31</span><span>		<span style="color:#8be9fd;font-style:italic">Some</span>(node.value)
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32</span><span>	}
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33</span><span>}
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Rust" data-lang="Rust"><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span><span style="color:#6272a4">// implement struct that keeps track of the current node pointer and make that struct public
</span></span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span><span><span style="color:#6272a4">// This syntax essentially says that the struct lives as long as the reference it contains,
</span></span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span><span><span style="color:#6272a4">// so that we don’t have issues with dangling pointers.
</span></span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span><span><span style="color:#6272a4"></span><span style="color:#ff79c6">pub</span> <span style="color:#ff79c6">struct</span> <span style="color:#50fa7b">LinkedListIter</span><span style="color:#ff79c6">&lt;&#39;</span><span style="color:#50fa7b">a</span>, T<span style="color:#ff79c6">&gt;</span> {
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span><span>	current: <span style="color:#ff79c6">&amp;</span><span style="color:#ff79c6">&#39;</span><span style="color:#50fa7b">a</span> <span style="color:#8be9fd;font-style:italic">Option</span><span style="color:#ff79c6">&lt;</span><span style="color:#8be9fd;font-style:italic">Box</span><span style="color:#ff79c6">&lt;</span>Node<span style="color:#ff79c6">&lt;</span>T<span style="color:#ff79c6">&gt;&gt;&gt;</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span><span>}
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span><span><span style="color:#ff79c6">impl</span><span style="color:#ff79c6">&lt;</span>T: <span style="color:#8be9fd;font-style:italic">Clone</span><span style="color:#ff79c6">&gt;</span> <span style="color:#8be9fd;font-style:italic">Iterator</span> <span style="color:#ff79c6">for</span> LinkedListIter<span style="color:#ff79c6">&lt;&#39;</span><span style="color:#8be9fd;font-style:italic">_</span>, T<span style="color:#ff79c6">&gt;</span> {
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span><span>	<span style="color:#ff79c6">type</span> <span style="color:#50fa7b">Item</span> <span style="color:#ff79c6">=</span> T;
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span><span>	<span style="color:#ff79c6">fn</span> <span style="color:#50fa7b">next</span>(<span style="color:#ff79c6">&amp;</span><span style="color:#ff79c6">mut</span> self) -&gt; <span style="color:#8be9fd;font-style:italic">Option</span><span style="color:#ff79c6">&lt;</span>T<span style="color:#ff79c6">&gt;</span> {
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span><span>		<span style="color:#ff79c6">match</span> self.current {
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span><span>			<span style="color:#8be9fd;font-style:italic">Some</span>(node) <span style="color:#ff79c6">=&gt;</span> {
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13</span><span>				self.current <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">&amp;</span>node.next;
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14</span><span>				<span style="color:#8be9fd;font-style:italic">Some</span>(node.value.clone())
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15</span><span>			},
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16</span><span>			<span style="color:#8be9fd;font-style:italic">None</span> <span style="color:#ff79c6">=&gt;</span> <span style="color:#8be9fd;font-style:italic">None</span>
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17</span><span>		}
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18</span><span>	}
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19</span><span>}
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21</span><span><span style="color:#6272a4">// Note that, in order to implement `IntoIterator` for `LinkedList&lt;T&gt;` 
</span></span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22</span><span><span style="color:#6272a4">// (as in, an iterator that will take ownership of the `LinkedList&lt;T&gt;` it is iterating over), 
</span></span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23</span><span><span style="color:#6272a4">// you can simply implement the `Iterator` trait for `LinkedList&lt;T&gt;`.
</span></span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24</span><span><span style="color:#6272a4"></span><span style="color:#ff79c6">impl</span><span style="color:#ff79c6">&lt;</span>T<span style="color:#ff79c6">&gt;</span> <span style="color:#8be9fd;font-style:italic">Iterator</span> <span style="color:#ff79c6">for</span> LinkedList<span style="color:#ff79c6">&lt;</span>T<span style="color:#ff79c6">&gt;</span> {
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25</span><span>	<span style="color:#ff79c6">type</span> <span style="color:#50fa7b">Item</span> <span style="color:#ff79c6">=</span> T;
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26</span><span>	<span style="color:#ff79c6">fn</span> <span style="color:#50fa7b">next</span>(<span style="color:#ff79c6">&amp;</span><span style="color:#ff79c6">mut</span> self) -&gt; <span style="color:#8be9fd;font-style:italic">Option</span><span style="color:#ff79c6">&lt;</span>Self::Item<span style="color:#ff79c6">&gt;</span> {
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27</span><span>		self.pop_front()
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28</span><span>	}
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29</span><span>}
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31</span><span><span style="color:#6272a4">// For `&amp;LinkedList&lt;T&gt;`, implement the trait only on types `T` that implement `Clone`,
</span></span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32</span><span><span style="color:#6272a4">// so that the `next` function returns copies of the elements in your collection.
</span></span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33</span><span><span style="color:#6272a4"></span><span style="color:#ff79c6">impl</span><span style="color:#ff79c6">&lt;&#39;</span><span style="color:#50fa7b">a</span>, T: <span style="color:#8be9fd;font-style:italic">Clone</span><span style="color:#ff79c6">&gt;</span> <span style="color:#8be9fd;font-style:italic">IntoIterator</span> <span style="color:#ff79c6">for</span> <span style="color:#ff79c6">&amp;&#39;</span><span style="color:#50fa7b">a</span> LinkedList<span style="color:#ff79c6">&lt;</span>T<span style="color:#ff79c6">&gt;</span> {
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34</span><span>	<span style="color:#ff79c6">type</span> <span style="color:#50fa7b">Item</span> <span style="color:#ff79c6">=</span> T;
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35</span><span>	<span style="color:#ff79c6">type</span> <span style="color:#50fa7b">IntoIter</span> <span style="color:#ff79c6">=</span> LinkedListIter<span style="color:#ff79c6">&lt;&#39;</span><span style="color:#50fa7b">a</span>, T<span style="color:#ff79c6">&gt;</span>;
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36</span><span>	<span style="color:#ff79c6">fn</span> <span style="color:#50fa7b">into_iter</span>(self) -&gt; <span style="color:#50fa7b">LinkedListIter</span><span style="color:#ff79c6">&lt;&#39;</span><span style="color:#50fa7b">a</span>, T<span style="color:#ff79c6">&gt;</span> {
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37</span><span>		LinkedListIter { current: <span style="color:#ff79c6">&amp;</span><span style="color:#50fa7b">self</span>.head }
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38</span><span>	}
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39</span><span>}
</span></span></code></pre></div><hr>
<p>我们的目标是为 <code>LinkedList&lt;T&gt;</code> 实现 <code>Iterator</code>，首先看 <code>LinkedListIter&lt;'a T&gt;</code>：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Rust" data-lang="Rust"><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span><span style="color:#6272a4">// implement struct that keeps track of the current node pointer and make that struct public
</span></span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span><span><span style="color:#6272a4">// This syntax essentially says that the struct lives as long as the reference it contains,
</span></span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span><span><span style="color:#6272a4">// so that we don’t have issues with dangling pointers.
</span></span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4</span><span><span style="color:#6272a4"></span><span style="color:#ff79c6">pub</span> <span style="color:#ff79c6">struct</span> <span style="color:#50fa7b">LinkedListIter</span><span style="color:#ff79c6">&lt;&#39;</span><span style="color:#50fa7b">a</span>, T<span style="color:#ff79c6">&gt;</span> {
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5</span><span>	current: <span style="color:#ff79c6">&amp;</span><span style="color:#ff79c6">&#39;</span><span style="color:#50fa7b">a</span> <span style="color:#8be9fd;font-style:italic">Option</span><span style="color:#ff79c6">&lt;</span><span style="color:#8be9fd;font-style:italic">Box</span><span style="color:#ff79c6">&lt;</span>Node<span style="color:#ff79c6">&lt;</span>T<span style="color:#ff79c6">&gt;&gt;&gt;</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6</span><span>}
</span></span></code></pre></div><p>我们创建 <code>LinkedListIter&lt;'a T&gt;</code> 来保存 <code>Iterator</code> 的状态。</p>
<p>这里指创建一个 <code>Option&lt;Box&lt;Node&lt;T&gt;&gt;&gt;</code> 的引用来保存当前 <code>LinkedList&lt;T&gt;</code> 里 <code>Node</code> 元素的位置信息，即迭代时我们可以知道进行到 collection 中哪一个元素。</p>
<p>为了创建 <code>Iterator</code>，接下来应该为 <code>LinkedListIter&lt;'a T&gt;</code> 实现 <code>Iterator Trait</code>。此时 <code>LinkedListIter&lt;'a T&gt;</code> 应是一个 <code>Iterator</code>。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Rust" data-lang="Rust"><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span><span style="color:#ff79c6">impl</span><span style="color:#ff79c6">&lt;</span>T: <span style="color:#8be9fd;font-style:italic">Clone</span><span style="color:#ff79c6">&gt;</span> <span style="color:#8be9fd;font-style:italic">Iterator</span> <span style="color:#ff79c6">for</span> LinkedListIter<span style="color:#ff79c6">&lt;&#39;</span><span style="color:#8be9fd;font-style:italic">_</span>, T<span style="color:#ff79c6">&gt;</span> {
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span><span>	<span style="color:#ff79c6">type</span> <span style="color:#50fa7b">Item</span> <span style="color:#ff79c6">=</span> T;
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span><span>	<span style="color:#ff79c6">fn</span> <span style="color:#50fa7b">next</span>(<span style="color:#ff79c6">&amp;</span><span style="color:#ff79c6">mut</span> self) -&gt; <span style="color:#8be9fd;font-style:italic">Option</span><span style="color:#ff79c6">&lt;</span>T<span style="color:#ff79c6">&gt;</span> {
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span><span>		<span style="color:#ff79c6">match</span> self.current {
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span><span>			<span style="color:#8be9fd;font-style:italic">Some</span>(node) <span style="color:#ff79c6">=&gt;</span> {
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span><span>				self.current <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">&amp;</span>node.next;
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span><span>				<span style="color:#8be9fd;font-style:italic">Some</span>(node.value.clone())
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span><span>			},
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span><span>			<span style="color:#8be9fd;font-style:italic">None</span> <span style="color:#ff79c6">=&gt;</span> <span style="color:#8be9fd;font-style:italic">None</span>
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span><span>		}
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span><span>	}
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span><span>}
</span></span></code></pre></div><p>实际上我们是为 <code>&amp;LinkedList&lt;T&gt;</code> collection 中实现 <code>Clone Trait</code> 的元素创建 <code>LinkedListIter&lt;'a T&gt; Iterator Trait</code> 的。</p>
<p>采取的方法是用 <code>LinkedListIter&lt;'a T&gt;</code> 记录当前 <code>Node</code> 元素信息（移指针）并弹出 <code>value</code> 的克隆值。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Rust" data-lang="Rust"><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span><span style="color:#6272a4">// Note that, in order to implement `IntoIterator` for `LinkedList&lt;T&gt;` 
</span></span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span><span><span style="color:#6272a4">// (as in, an iterator that will take ownership of the `LinkedList&lt;T&gt;` it is iterating over), 
</span></span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span><span><span style="color:#6272a4">// you can simply implement the `Iterator` trait for `LinkedList&lt;T&gt;`.
</span></span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4</span><span><span style="color:#6272a4"></span><span style="color:#ff79c6">impl</span><span style="color:#ff79c6">&lt;</span>T<span style="color:#ff79c6">&gt;</span> <span style="color:#8be9fd;font-style:italic">Iterator</span> <span style="color:#ff79c6">for</span> LinkedList<span style="color:#ff79c6">&lt;</span>T<span style="color:#ff79c6">&gt;</span> {
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5</span><span>	<span style="color:#ff79c6">type</span> <span style="color:#50fa7b">Item</span> <span style="color:#ff79c6">=</span> T;
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6</span><span>	<span style="color:#ff79c6">fn</span> <span style="color:#50fa7b">next</span>(<span style="color:#ff79c6">&amp;</span><span style="color:#ff79c6">mut</span> self) -&gt; <span style="color:#8be9fd;font-style:italic">Option</span><span style="color:#ff79c6">&lt;</span>Self::Item<span style="color:#ff79c6">&gt;</span> {
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7</span><span>		self.pop_front()
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">8</span><span>	}
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">9</span><span>}
</span></span></code></pre></div><p>对于其他的普遍情况，当然也可以直接为 <code>LinkedList&lt;T&gt;</code> 实现 <code>Iterator Trait</code>，进而实现 <code>LinkedList&lt;T&gt;</code> 的 <code>IntoIterator Trait</code>，因为所有 <code>Iterator</code> 都通过<strong>返回自身</strong>来<strong>实现 <code>IntoIterator</code></strong>。此时对 <code>T</code> 没有要求。</p>
<p>由于已经为 <code>LinkedList&lt;T&gt;</code> collection 实现了 <code>Iterator</code>，允许 <code>LinkedList&lt;T&gt;</code> collection 与 <code>for</code> 循环一起使用。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Rust" data-lang="Rust"><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span><span style="color:#6272a4">// For `&amp;LinkedList&lt;T&gt;`, implement the trait only on types `T` that implement `Clone`,
</span></span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span><span><span style="color:#6272a4">// so that the `next` function returns copies of the elements in your collection.
</span></span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span><span><span style="color:#6272a4"></span><span style="color:#ff79c6">impl</span><span style="color:#ff79c6">&lt;&#39;</span><span style="color:#50fa7b">a</span>, T: <span style="color:#8be9fd;font-style:italic">Clone</span><span style="color:#ff79c6">&gt;</span> <span style="color:#8be9fd;font-style:italic">IntoIterator</span> <span style="color:#ff79c6">for</span> <span style="color:#ff79c6">&amp;&#39;</span><span style="color:#50fa7b">a</span> LinkedList<span style="color:#ff79c6">&lt;</span>T<span style="color:#ff79c6">&gt;</span> {
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4</span><span>	<span style="color:#ff79c6">type</span> <span style="color:#50fa7b">Item</span> <span style="color:#ff79c6">=</span> T;
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5</span><span>	<span style="color:#ff79c6">type</span> <span style="color:#50fa7b">IntoIter</span> <span style="color:#ff79c6">=</span> LinkedListIter<span style="color:#ff79c6">&lt;&#39;</span><span style="color:#50fa7b">a</span>, T<span style="color:#ff79c6">&gt;</span>;
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6</span><span>	<span style="color:#ff79c6">fn</span> <span style="color:#50fa7b">into_iter</span>(self) -&gt; <span style="color:#50fa7b">LinkedListIter</span><span style="color:#ff79c6">&lt;&#39;</span><span style="color:#50fa7b">a</span>, T<span style="color:#ff79c6">&gt;</span> {
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7</span><span>		LinkedListIter { current: <span style="color:#ff79c6">&amp;</span><span style="color:#50fa7b">self</span>.head }
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">8</span><span>	}
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">9</span><span>}
</span></span></code></pre></div><p>为 <code>&amp;LinkedList&lt;T&gt;</code> collection 中元素实现 <code>Clone Trait</code> 的元素的情况下实现 <code>IntoIterator</code>，利用 <code>into_iter</code> 函数把实现 <code>IntoIterator Trait</code> 的 <code>&amp;LinkedList&lt;T&gt;</code> 转换成一个 <code>LinkedListIter&lt;'a T&gt; Iterator</code>。</p>
<p>此举的目的是为 <code>&amp;LinkedList&lt;T&gt;</code> collection 中实现 <code>Clone Trait</code> 的元素构造 <code>Iterator</code>，因此特意构造出 <code>LinkedListIter&lt;'a T&gt; Iterator</code>。</p>
<p>由于已经为 <code>&amp;LinkedList&lt;T&gt;</code> collection 实现了 <code>IntoIterator</code>，因此这将允许 <code>&amp;LinkedList&lt;T&gt;</code> collection 与 <code>for</code> 循环一起使用。</p>
<h3 id="代码实例">代码实例</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Rust" data-lang="Rust"><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span><span style="color:#8be9fd;font-style:italic">let</span> <span style="color:#ff79c6">mut</span> list: <span style="color:#50fa7b">LinkedList</span><span style="color:#ff79c6">&lt;</span><span style="color:#8be9fd">u32</span><span style="color:#ff79c6">&gt;</span> <span style="color:#ff79c6">=</span> LinkedList::new();
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span><span><span style="color:#ff79c6">for</span> i <span style="color:#ff79c6">in</span> <span style="color:#bd93f9">1</span><span style="color:#ff79c6">..</span><span style="color:#bd93f9">12</span> {
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span><span>	list.push_front(i);
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span><span>}
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span><span><span style="color:#6272a4">// ---------------------------------------------------
</span></span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span><span><span style="color:#6272a4"></span><span style="color:#ff79c6">for</span> x <span style="color:#ff79c6">in</span> list {
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span><span>    println!(<span style="color:#f1fa8c">&#34;{}&#34;</span>, x);
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span><span>}
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span><span><span style="color:#6272a4">// 等价于
</span></span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13</span><span><span style="color:#6272a4"></span><span style="color:#8be9fd;font-style:italic">let</span> <span style="color:#ff79c6">mut</span> iter <span style="color:#ff79c6">=</span> <span style="color:#8be9fd;font-style:italic">IntoIterator</span>::into_iter(list);
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14</span><span><span style="color:#ff79c6">loop</span> {
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15</span><span>	<span style="color:#ff79c6">match</span> iter.next() {
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16</span><span>		<span style="color:#8be9fd;font-style:italic">Some</span>(x) <span style="color:#ff79c6">=&gt;</span> {
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17</span><span>			println!(<span style="color:#f1fa8c">&#34;{}&#34;</span>, x);
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18</span><span>		},
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19</span><span>		<span style="color:#8be9fd;font-style:italic">None</span> <span style="color:#ff79c6">=&gt;</span> <span style="color:#ff79c6">break</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20</span><span>	}
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21</span><span>}
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Rust" data-lang="Rust"><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span><span style="color:#8be9fd;font-style:italic">let</span> <span style="color:#ff79c6">mut</span> strings: <span style="color:#50fa7b">LinkedList</span><span style="color:#ff79c6">&lt;</span><span style="color:#8be9fd;font-style:italic">String</span><span style="color:#ff79c6">&gt;</span> <span style="color:#ff79c6">=</span> LinkedList::new();
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span><span>strings.push_front(<span style="color:#f1fa8c">&#34;a&#34;</span>.to_string());
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span><span>strings.push_front(<span style="color:#f1fa8c">&#34;b&#34;</span>.to_string());
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span><span>strings.push_front(<span style="color:#f1fa8c">&#34;c&#34;</span>.to_string());
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span><span>strings.push_front(<span style="color:#f1fa8c">&#34;d&#34;</span>.to_string());
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span><span><span style="color:#ff79c6">for</span> p <span style="color:#ff79c6">in</span> <span style="color:#ff79c6">&amp;</span>strings {
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span><span>	println!(<span style="color:#f1fa8c">&#34;{}&#34;</span>, p);
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span><span>}
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span><span><span style="color:#6272a4">// -------------------------------------------------------
</span></span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span><span><span style="color:#6272a4">// 等价于
</span></span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13</span><span><span style="color:#6272a4"></span>{
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14</span><span>    <span style="color:#8be9fd;font-style:italic">let</span> result <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">match</span> <span style="color:#8be9fd;font-style:italic">IntoIterator</span>::into_iter(<span style="color:#ff79c6">&amp;</span>strings) {
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15</span><span>        <span style="color:#ff79c6">mut</span> iter <span style="color:#ff79c6">=&gt;</span> <span style="color:#ff79c6">loop</span> {
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16</span><span>            <span style="color:#8be9fd;font-style:italic">let</span> next;
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17</span><span>            <span style="color:#ff79c6">match</span> iter.next() {
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18</span><span>                <span style="color:#8be9fd;font-style:italic">Some</span>(val) <span style="color:#ff79c6">=&gt;</span> next <span style="color:#ff79c6">=</span> val,
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19</span><span>                <span style="color:#8be9fd;font-style:italic">None</span> <span style="color:#ff79c6">=&gt;</span> <span style="color:#ff79c6">break</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20</span><span>            };
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21</span><span>            <span style="color:#8be9fd;font-style:italic">let</span> x <span style="color:#ff79c6">=</span> next;
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22</span><span>            <span style="color:#8be9fd;font-style:italic">let</span> () <span style="color:#ff79c6">=</span> { println!(<span style="color:#f1fa8c">&#34;{}&#34;</span>, x); };
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23</span><span>        },
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24</span><span>    };
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25</span><span>    result
</span></span><span style="display:flex;"><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26</span><span>}
</span></span></code></pre></div>
    </div>
  </article>

  
  






  <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about">About</a></li>
         
          <li><a href="/posts">All posts</a></li>
         
          <li><a href="/index.xml">RSS</a></li>
        
      </ul>
    </div>

    
    <div id="toc-footer" style="display: none">
      <nav id="TableOfContents">
  <ul>
    <li><a href="#iterator">Iterator</a>
      <ul>
        <li><a href="#iterators-and-iterables-inrust">Iterators and “iterables” in Rust</a></li>
        <li><a href="#the-three-forms-of-iteration">The three forms of iteration</a></li>
        <li><a href="#implementing-iterator">Implementing Iterator</a>
          <ul>
            <li><a href="#for-loops-and-intoiterator"><code>for</code> loops and <code>IntoIterator</code></a></li>
          </ul>
        </li>
        <li><a href="#代码分析">代码分析</a></li>
        <li><a href="#代码实例">代码实例</a></li>
      </ul>
    </li>
  </ul>
</nav>
    </div>
    

    <div id="share-footer" style="display: none">
      
      <ul>
  
  
    
  
  
  <li>
    <a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fwhx828.github.io%2fposts%2frust%25E7%259A%2584%25E8%25BF%25AD%25E4%25BB%25A3%25E5%2599%25A8%2f" aria-label="Facebook">
      <i class="fab fa-facebook fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://twitter.com/share?url=https%3a%2f%2fwhx828.github.io%2fposts%2frust%25E7%259A%2584%25E8%25BF%25AD%25E4%25BB%25A3%25E5%2599%25A8%2f&text=Rust%20%e7%9a%84%e8%bf%ad%e4%bb%a3%e5%99%a8" aria-label="Twitter">
      <i class="fab fa-twitter fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2fwhx828.github.io%2fposts%2frust%25E7%259A%2584%25E8%25BF%25AD%25E4%25BB%25A3%25E5%2599%25A8%2f&title=Rust%20%e7%9a%84%e8%bf%ad%e4%bb%a3%e5%99%a8" aria-label="Linkedin">
      <i class="fab fa-linkedin fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2fwhx828.github.io%2fposts%2frust%25E7%259A%2584%25E8%25BF%25AD%25E4%25BB%25A3%25E5%2599%25A8%2f&is_video=false&description=Rust%20%e7%9a%84%e8%bf%ad%e4%bb%a3%e5%99%a8" aria-label="Pinterest">
      <i class="fab fa-pinterest fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="mailto:?subject=Rust%20%e7%9a%84%e8%bf%ad%e4%bb%a3%e5%99%a8&body=Check out this article: https%3a%2f%2fwhx828.github.io%2fposts%2frust%25E7%259A%2584%25E8%25BF%25AD%25E4%25BB%25A3%25E5%2599%25A8%2f" aria-label="Email">
      <i class="fas fa-envelope fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2fwhx828.github.io%2fposts%2frust%25E7%259A%2584%25E8%25BF%25AD%25E4%25BB%25A3%25E5%2599%25A8%2f&title=Rust%20%e7%9a%84%e8%bf%ad%e4%bb%a3%e5%99%a8" aria-label="Pocket">
      <i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2fwhx828.github.io%2fposts%2frust%25E7%259A%2584%25E8%25BF%25AD%25E4%25BB%25A3%25E5%2599%25A8%2f&title=Rust%20%e7%9a%84%e8%bf%ad%e4%bb%a3%e5%99%a8" aria-label="reddit">
      <i class="fab fa-reddit fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.tumblr.com/share/link?url=https%3a%2f%2fwhx828.github.io%2fposts%2frust%25E7%259A%2584%25E8%25BF%25AD%25E4%25BB%25A3%25E5%2599%25A8%2f&name=Rust%20%e7%9a%84%e8%bf%ad%e4%bb%a3%e5%99%a8&description=Iterator%20Iterators%20and%20%e2%80%9citerables%e2%80%9d%20in%c2%a0Rust%20The%20iterator%20keeps%20track%20of%20what%20element%20it%26rsquo%3bs%20currently%20pointing%20to%20and%20supports%20at%20least%20the%20following%20basic%c2%a0operations%3a%0aIterator%20%e8%b7%9f%e8%b8%aa%e5%ae%83%e5%bd%93%e5%89%8d%e6%8c%87%e5%90%91%e7%9a%84%e5%85%83%e7%b4%a0%ef%bc%8c%e5%b9%b6%e8%87%b3%e5%b0%91%e6%94%af%e6%8c%81%e4%bb%a5%e4%b8%8b%e5%9f%ba%e6%9c%ac%e6%93%8d%e4%bd%9c%ef%bc%9a%0a%20getting%20the%20current%c2%a0element%20%e8%8e%b7%e5%8f%96%e5%bd%93%e5%89%8d%e5%85%83%e7%b4%a0%20advancing%20to%20the%20next%c2%a0element%20%e5%89%8d%e8%bf%9b%e5%88%b0%e4%b8%8b%e4%b8%80%e4%b8%aa%e5%85%83%e7%b4%a0%20signaling%20when%20no%20more%20elements%20are%c2%a0available%20%e5%bd%93%e6%b2%a1%e6%9c%89%e6%9b%b4%e5%a4%9a%e5%85%83%e7%b4%a0%e5%8f%af%e7%94%a8%e6%97%b6%e5%8f%91%e5%87%ba%e4%bf%a1%e5%8f%b7%20%20Some%20languages%20provide%20separate%20iterator%20methods%20for%20each%20of%20those%20tasks%2c%20but%20Rust%20chooses%20to%20combine%20them%20all%20into%20one.%20You%20can%20see%20that%20when%20looking%20at%20the%20Iterator%20trait%3a%20next%20is%20the%20only%20method%20to%20be%20provided%20by%20its%c2%a0implementations." aria-label="Tumblr">
      <i class="fab fa-tumblr fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fwhx828.github.io%2fposts%2frust%25E7%259A%2584%25E8%25BF%25AD%25E4%25BB%25A3%25E5%2599%25A8%2f&t=Rust%20%e7%9a%84%e8%bf%ad%e4%bb%a3%e5%99%a8" aria-label="Hacker News">
      <i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i>
    </a>
  </li>
</ul>

    </div>

    <div id="actions-footer">
      
        <a id="menu-toggle" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;" aria-label="Menu">
          <i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        
        <a id="toc-toggle" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;" aria-label="TOC">
          <i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        
        <a id="share-toggle" class="icon" href="#" onclick="$('#share-footer').toggle();return false;" aria-label="Share">
          <i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" aria-label="Top of Page">
          <i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>


  <footer id="footer">
  <div class="footer-left">
    Copyright  &copy; 2022  whx All rights reserved 
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
        <li><a href="/">Home</a></li>
         
        <li><a href="/about">About</a></li>
         
        <li><a href="/posts">All posts</a></li>
         
        <li><a href="/index.xml">RSS</a></li>
        
      </ul>
    </nav>
  </div>
</footer>


  </div>
</body>

<link rel="stylesheet" href=/lib/font-awesome/css/all.min.css>
<script src=/lib/jquery/jquery.min.js></script>
<script src=/js/main.js></script>

<script src=/js/code-copy.js></script>




</html>
